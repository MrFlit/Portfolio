<!-- Created by Mr Flit -->

<!doctype html>
<html>
 <head>
  <title>Калькулятор</title>
  <meta charset="utf-8" />
  <link rel="stylesheet" href="style.css">
  <link
   href="https://fonts.googleapis.com/css2?family=MuseoModerno:wght@500&display=swap"
   rel="stylesheet">
 </head>
 <body>
  <input id='result' placeholder="0" disabled>
  <div class='pad_calculator'>
   <div class='conteneir'>
    <tr>
     <td><button class='pad'
       id='clear_button'>C</button></td>
     <td><button class='pad' id='back_btn'>></button>
     </td>
     <td><button class='pad'
       id='change-sign-btn'>±</button>
     </td>
     <td><button class='right' id='plus-btn'
       onclick="calc(' / ');">÷</button>
     </td>
     <td><button class='special'
       onclick='Paren()'>()</button>
     </td>
    </tr>
    <br>
    <tr>
     <td><button class='pad'
       onclick='calc(7)'>7</button>
     </td>
     <td><button class='pad'
       onclick='calc(8)'>8</button>
     </td>
     <td><button class='pad'
       onclick='calc(9)'>9</button>
     </td>
     <td><button class='right'
       onclick="calc(' * ')">×</button>
     </td>
     <td><button class='special'
       onclick='round()'>R</button>
     </td>
    </tr>
    <br>
    <tr>
     <td><button class='pad'
       onclick='calc(4)'>4</button>
     </td>
     <td><button class='pad'
       onclick='calc(5)'>5</button>
     </td>
     <td><button class='pad'
       onclick='calc(6)'>6</button>
     </td>
     <td><button class='right'
       onclick="calc(' - ')">-</button>
     </td>
     <td><button class='special'
       onclick='calc("-")'>-</button>
     </td>
    </tr>
    <br>
    <tr>
     <td><button class='pad'
       onclick='calc(1)'>1</button>
     </td>
     <td><button class='pad'
       onclick='calc(2)'>2</button>
     </td>
     <td><button class='pad'
       onclick='calc(3)'>3</button>
     </td>
     <td><button class='right'
       onclick="calc(' + ')">+</button>
     </td>
     <td><button class='special'
       onclick='RootSquare()'>√</button>
     </td>
    </tr>
    <br>
    <tr>
     <td><button class='large'
       onclick='calc(0)'>0</button>
     </td>
     <td><button class='pad'
       onclick='calc(".")'>.</button>
     </td>
     <td><button class='right'
       onclick="result()">=</button>
     </td>
     <td><button class='special'
       onclick="calc('²')">e²</button>
     </td>
    </tr>
    <p id='msg_alert'><span>× Error -
     </span><span id='alert'></span> -
     <button class='cancel_alert'
      onclick="cancel()">OK</button></p>
   </div>
  </div>
  <button class='style1' id='btn_history'
   onclick='historyAnimations()'>История</button>
  <div class='histoty' id='histoty'>
   <div class='contener-history'>
    <h1>Твоя история : </h1>
    <div>
     <h3 id='message-h3'>Ты еще не посчитал</h3>
     <ol id='ol-history' type='I'>
     </ol>
    </div>
   </div>
  </div>
  <div class='new-up' id='new-up'>
   <span> Инфо: </span><span class='btn-cancel-news'
    id='btn-cancel-news'>×</span>
   <ul>
    <li>Если скобки ошибаются, пожалуйста
     очистить расчеты<br>
	 Created by Mr Flit</li>
   </ul>
  </div>
  <script>
  

function calc(num) {

 document.getElementById('result')
  .value += num;

}

function clear() {

 document.getElementById('result')
  .value = '';

 paren_bolean = false;

}

function back() {

 var x = document.getElementById(
  'result').value;

 document.getElementById('result')
  .value = x.substring(0, x.length -
   1);

 if (document.getElementById(
   'result').value === '') {

  paren_bolean = false;

 }

}





function change() {

 var x = document.getElementById(
  'result').value;

 document.getElementById('result')
  .value = (x - 2 * x);

 if (document.getElementById(
   'result').value === 'NaN') {

  document.getElementById('result')
   .value = alert_msg(
    "Расчеты не верны");

 }

}





function alert_msg(msg) {

 document.getElementById('alert')
  .innerHTML = msg;

 document.getElementById('msg_alert')
  .style.display = 'block';

}

function cancel() {

 document.getElementById('msg_alert')
  .style.display = 'none';

}



var paren_bolean = false;



function Paren() {

 var x = document.getElementById(
  'result').value;

 if (paren_bolean === false) {

  calc('(');

 } else {

  calc(')');

 }

 paren_bolean = !paren_bolean;

}





function RootSquare() {

 calc('√');

 Paren();

}





var typeOfCalc = [];

function result() {

 typeOfCalc = []

 var x = document.getElementById(
  'result').value;

 var caclHistory = document
  .getElementById('result').value;

 

 if (x.includes('²') === true) {

  do {

   const k = x.substring(0, x
    .indexOf('²'));

   const atReplace = x.substring(k
    .lastIndexOf(' ') + 1, x
    .indexOf('²') + 1);

   const result = k.substring(k
     .lastIndexOf(' '), k.length) * k
    .substring(k.lastIndexOf(' '), k
     .length);

   x = x.replace(atReplace
    .toString(), result.toString());

  } while (x.includes('²') === true);

  document.getElementById('result')
   .value = x;

  typeOfCalc.push(' Степень');

 }



 if (x.includes('√') === true) {

  do {

   x = x.replace('√(' + x.substring(x
     .indexOf('√') + 2, x.length)
    .substring(x.substring(x
      .indexOf('√') + 2, x.length),
     x.substring(x.indexOf('√') + 2,
      x.length).indexOf(')')) + ')',
    Math.sqrt(x.substring(x.indexOf(
     '√') + 2, x.length).substring(
     x.substring(x.indexOf('√') +
      2, x.length), x.substring(x
      .indexOf('√') + 2, x.length)
     .indexOf(')'))));

  } while (x.includes('√') === true);

  document.getElementById('result')
   .value = x;

  typeOfCalc.push(' Корень');

 }

 

 function history() {

  document.getElementById(
    'message-h3').style.display =
   'none';

  if (x.includes('+') === true) {

   typeOfCalc.push(' Сложение');

  }

  if (x.includes('-') === true) {

   var y = x;

   do {

    if (y.startsWith('-') === true) {

     y = y.substring(y.length, 1);

    } else if (y.includes('-') ===
     true) {

     typeOfCalc.push(' Вычитание');

     y = 'nothing';

    }

   } while (y.includes('-') ===
    true);

  }

  if (x.includes('*') === true) {

   typeOfCalc.push(
    ' Умножение');

  }

  if (x.includes('/') === true) {

   typeOfCalc.push(' Деление');

  }

  document.getElementById(
    'message-h3').style.display =
   'none';

  document.getElementById(
    'ol-history').innerHTML +=
   '<li><span class="calcule">' +
   caclHistory +
   '</span><span class="calc-type"> ' +
   typeOfCalc +
   ' </span><span class="calcule">Результат : ' +
   eval(x) + '</span></li>';

 }

 history();

 if (x) {

  document.getElementById('result')
   .value = eval(x);

 }

}





var hide = true;

function historyAnimations() {

 hide = !hide;

 document.getElementById('histoty')
  .style.transition = '0.5s';

 document.getElementById('histoty')
  .style.webkitTransition = '0.5s';

 if (hide === false) {

  document.getElementById('histoty')
   .style.opacity = '1';

 } else if (hide === true) {

  document.getElementById('histoty')
   .style.opacity = '0';

 }

}




function round() {

 document.getElementById(
   'message-h3').style.display =
  'none';

 var x = document.getElementById(
  'result').value;

 if (x === 0 || x.includes('.') ===
  false) {

  document.getElementById('result')
   .value = alert_msg(
    "Вы не можете округлить это!");

  document.getElementById('result')
   .value = 'Невозможно';

  paren_bolean = false;

 } else if (x !== 0 || x.includes(
   '.') === true) {

  document.getElementById('result')
   .value = Math.round(x);

  document.getElementById(
    'ol-history').innerHTML +=
   '<li><span class="calcule"> Round(' +
   x +
   ')</span><span class="calc-type"> round </span><span class="calcule">Результат : ' +
   Math.round(x) + '</span></li>';

 } else {

 }

}




function newsHide() {

 document.getElementById('new-up')
  .style.display = 'none';

}


document.getElementById(
 'clear_button').onclick = clear;

document.getElementById('back_btn')
 .onclick = back;

document.getElementById(
 'change-sign-btn').onclick = change;

document.getElementById(
  'btn-cancel-news')
 .addEventListener('click',
  newsHide);

 </script>
 </body>
</html>